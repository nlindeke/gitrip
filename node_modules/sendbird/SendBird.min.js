/**
 * SendBird JavaScript SDK v2.4.18
 */
!function(e,n){var t=n();"function"==typeof define&&define.amd?define([],t.getInstance()):"object"==typeof exports?(module.exports=t.getInstance(),module.exports.SB=t,module.exports.sendbird=t.getInstance()):(e.SB=t,e.sendbird=t.getInstance())}(this,function(){function e(){try{if("undefined"==typeof navigator||"undefined"==typeof navigator.userAgent)return!1;var e=navigator.userAgent.toLowerCase();return-1!=e.indexOf("msie")?parseInt(e.split("msie")[1]):!1}catch(n){return!1}}function n(n,r,s,i,a,o){var c=t?new t:new XMLHttpRequest,u=e();if(!("withCredentials"in c)&&u&&10>u){c=new XDomainRequest,c.withCredentials=!0;try{switch(s.toLowerCase()){case"get":c.open("GET",n);break;default:c.open("POST",n)}}catch(g){c.open("POST",n)}for(var _ in i)r[_]=i[_];c.onload=function(){var e=JSON.parse(c.responseText);e.error?o(c.status,c.statusText):a(e)},c.onerror=function(){o(404,"There was a connection error")}}else{try{switch(c=t?new t:new XMLHttpRequest,s.toLowerCase()){case"get":c.open("GET",n);break;default:c.open("POST",n)}c.onload=function(){if(c.status>=p&&c.status<d){var e=c.responseText;a(JSON.parse(e))}else o(c.status,c.statusText)},c.onerror=function(){o(404,"There was a connection error")}}catch(f){c=new ActiveXObject("Microsoft.XMLHTTP");try{switch(s.toLowerCase()){case"get":c.open("GET",n);break;default:c.open("POST",n)}}catch(g){c.open("POST",n)}c.onreadystatechange=function(){if(4==c.readyState)if(c.status>=p&&c.status<d){var e=c.responseText;a(JSON.parse(e))}else o(c.status,c.statusText)}}c.setRequestHeader("Content-Type","text/plain; charset=UTF-8");for(var _ in i)c.setRequestHeader(_,i[_])}switch(s.toLowerCase()){case"get":c.send();break;default:c.send(JSON.stringify(r))}}var t,r;try{t="undefined"==typeof window?require("xhr2"):null}catch(s){t=null}try{r="undefined"==typeof WebSocket?require("websocket").w3cwebsocket:WebSocket}catch(s){r=WebSocket}var i=!1,a=!1;try{var o=window.console||{log:function(){}}}catch(c){var o={log:function(){}}}var u=function(e){i&&o.log(e)},g=function(e){e=e||{};for(var n=arguments.length,t=1;n>t;t++)if(arguments[t])for(var r in arguments[t])arguments[t].hasOwnProperty(r)&&(e[r]=arguments[t][r]);return e};"function"!=typeof String.prototype.trim&&(String.prototype.trim=function(){return this.replace(/^\s+|\s+$/g,"")});var p=200,d=400,_=function(){function e(){var e=new f;return e}var n,t=function(t){var r=g({},{newInstance:!1},t);return r.newInstance?e():(n||(n=e()),n)};return{getInstance:t}}(),f=function(){function e(e){return _(k+C.app_id),l+"v"+S.replace(/[^(0-9)]/gi,"")+"/"+e}function s(e){return _(k+C.app_id),l+"v3/"+e}function c(){0!==O&&(F=3e3,M=5,O=0,u("=== Reset Reconnect Values ==="))}function _(e,t,r){if(v)m="ws://localtest.me:9000",l="http://api.localtest.me:8000/","function"==typeof t&&t();else{var s=(new Date).getTime()/1e3;0==U||U-s>300?n(e,{},"GET",{SendBird:R+C.app_id},function(e){m=e.ws_server,l=e.api_server+"/",u("Routing Info Update: "+m+", "+l),U=s,"function"==typeof t&&t()},function(e,n){"function"==typeof r&&r(e,n)}):"function"==typeof t&&t()}}function f(e){C.app_id=e.app_id,C.guest_id=e.guest_id,C.user_name=e.user_name,C.image_url=void 0==e.image_url||null==e.image_url?"":e.image_url,C.access_token=void 0==e.access_token||null==e.access_token?"":e.access_token,X({successFunc:function(n){e.successFunc(n)},errorFunc:function(n,t){e.errorFunc(n,t)},async:e.async})}var l,m,v=!1,S="1",k="https://api.sendbird.com/routing/",y="2.4.18";try{var h=encodeURI(navigator.userAgent)}catch(T){var h="undefined"}var F,M,O,P="/?p=JS&pv="+h+"&sv="+y+"&ai=",R="JS,"+h+","+y+",",w=null,N={MESG:"MESG",FILE:"FILE",LOGI:"LOGI",JOIN:"JOIN",SYSM:"SYSM",BRDM:"BRDM",MCUP:"MCUP",READ:"READ",TPST:"TPST",TPEN:"TPEN",BAAN:"BAAN",FREZ:"FREZ",PING:"PING",PONG:"PONG"},C={},b={},I=0,E=0,G=null,B=null,L=null,D=0,J=!1,A=0,x=1e4,U=0;c();var z=function(e,n){switch(e){case N.MESG:W.onMessageReceived(JSON.parse(n));break;case N.SYSM:W.onSystemMessageReceived(JSON.parse(n));break;case N.FILE:W.onFileMessageReceived(JSON.parse(n));break;case N.BRDM:W.onBroadcastMessageReceived(JSON.parse(n));break;case N.TPST:W.onTypeStartReceived(JSON.parse(n));break;case N.TPEN:W.onTypeEndReceived(JSON.parse(n));break;case N.PONG:c(),u(N.PONG);break;case N.READ:W.onReadReceived(JSON.parse(n));break;case N.BAAN:W.onBanReceived(JSON.parse(n));break;case N.FREZ:var t=JSON.parse(n),r=!1;try{r=t.freeze}catch(s){r=!1}b.data=JSON.stringify({freeze:r}),W.onChannelFreezeReceived(t);break;default:W.onUndefinedMessageReceived(e,JSON.parse(n))}return JSON.parse(n)},q={successFunc:function(e){},errorFunc:function(e,n){u(e),u(n)}},W={onMessageReceived:function(e){u(e)},onSystemMessageReceived:function(e){u(e)},onFileMessageReceived:function(e){u(e)},onBroadcastMessageReceived:function(e){u(e)},onReadReceived:function(e){u(e)},onMessagingChannelUpdateReceived:function(e){u(e)},onTypeStartReceived:function(e){u(e)},onTypeEndReceived:function(e){u(e)},onMessageDelivery:function(e){u(e)},onBanReceived:function(e){u(e)},onChannelFreezeReceived:function(e){u(e)},onUndefinedMessageReceived:function(e,n){u(e),u(n)},onReconnectFailed:function(){}},H=6,j=5,X=function(t){u("=== Start SendBird SDK ===");var r=g({},q,t),s="guest_login/",i={guest_id:C.guest_id,app_id:C.app_id,nickname:C.user_name,image_url:C.image_url,access_token:C.access_token};void 0!=C.gcm_reg_token&&""!=C.gcm_reg_token&&(i.gcm_reg_token=C.gcm_reg_token),void 0!=C.apns_device_token&&""!=C.apns_device_token&&(i.apns_device_token=C.apns_device_token),_(k+C.app_id,function(){n(e(s),i,"POST",{SendBird:R+C.app_id},function(e){e.error?r.errorFunc(p,e.message):(C.guest_key=e.key,C.remove_apns_token&&Ue(C.remove_apns_token),C.remove_gcm_token&&xe(C.remove_gcm_token),r.successFunc({}))},function(e,n){r.errorFunc(e,n)})},function(e,n){r.errorFunc(e,n)})},Y=function(t,r){u("=== Join Channel ===");var s=g({},q,r),i="channel_join/",a={app_id:C.app_id,session_key:C.guest_key,channel_url:t},o={};n(e(i),a,"POST",{SendBird:R+C.app_id},function(e){e.error?s.errorFunc(p,e.message):(e.isMessaging=!1,g(b,e),o=b,s.successFunc(o))},function(e,n){s.errorFunc(e,n)})},Z=function(t,r){u("=== Leave Channel ===");var s=g({},q,r),i="channel_leave",a={app_id:C.app_id,session_key:C.guest_key,channel_url:t},o={};n(e(i),a,"POST",{SendBird:R+C.app_id},function(e){e.error?s.errorFunc(p,e.message):(o=e,s.successFunc(o))},function(e,n){s.errorFunc(e,n)})},K=function(t,r){u("=== Member List ===");var s=g({},q,r),i="member_list/",a={app_id:C.app_id,channel_url:t},o={};n(e(i),a,"POST",{SendBird:R+C.app_id},function(e){e.error?s.errorFunc(p,e.message):(o=e,s.successFunc(o))},function(e,n){s.errorFunc(e,n)})},V=function(t){u("=== Channel List ==="),t=g({},{limit:20,page:1,query:""},t);var r=g({},q,t),s="channel_list/",i={app_id:C.app_id,page:r.page,limit:r.limit,query:r.query},a={};n(e(s),i,"POST",{SendBird:R+C.app_id},function(e){e.error?r.errorFunc(p,e.message):(a=e,r.successFunc(a))},function(e,n){r.errorFunc(e,n)})},$=function(e){V(e)},Q=function(e){return void 0!=e.last_message&&""!=e.last_message&&(e.last_message=JSON.parse(e.last_message.substring(4))),e},ee=function(t,r){u("=== Join Messaging Channel ===");var s=g({},q,r),i="messaging_join/",a={app_id:C.app_id,session_key:C.guest_key,channel_url:t},o={};n(e(i),a,"POST",{SendBird:R+C.app_id},function(e){e.error?s.errorFunc(p,e.message):(e.channel.isMessaging=!0,g(b,e.channel),o=e,s.successFunc(Q(o)))},function(e,n){s.errorFunc(e,n)})},ne=function(t,r){u("=== Start Messaging ==="),r=g({},{is_group:!1},r),t=t instanceof Array?t:new Array(t);var s=g({},q,r),i="messaging_start/",a={app_id:C.app_id,session_key:C.guest_key,guest_ids:t,is_group:r.is_group},o={};n(e(i),a,"POST",{SendBird:R+C.app_id},function(e){e.error?s.errorFunc(p,e.message):(g(b,e.channel),o=e,s.successFunc(Q(o)))},function(e,n){s.errorFunc(e,n)})},te=function(e,n,t){if(2==arguments.length){var r=arguments[1].channel_url;void 0!=r&&""!=r||(r=b.channel_url),re(arguments[0],r,arguments[1])}else re(e,n,t)},re=function(t,r,s){u("=== Invite Messaging ==="),t=t instanceof Array?t:new Array(t);var i=g({},q,s),a="messaging_invite/",o={app_id:C.app_id,session_key:C.guest_key,channel_url:r,guest_ids:t},c={};n(e(a),o,"POST",{SendBird:R+C.app_id},function(e){e.error?i.errorFunc(p,e.message):(g(b,e.channel),c=e,i.successFunc(Q(c)))},function(e,n){i.errorFunc(e,n)})},se=function(t,r){u("=== End Messaging ===");var s=g({},q,r),i="messaging_end/",a={app_id:C.app_id,session_key:C.guest_key,channel_url:t},o={};n(e(i),a,"POST",{SendBird:R+C.app_id},function(e){e.error?s.errorFunc(p,e.message):(g(b,e),o=e,s.successFunc(Q(o)))},function(e,n){s.errorFunc(e,n)})},ie=function(t){u("=== Get Messaging Channel List (Deprecated) ==="),t=g({},{limit:9999,page:1},t);var r=g({},q,t),s="messaging_list/",i={app_id:C.app_id,session_key:C.guest_key,page:r.page,limit:r.limit},a={};n(e(s),i,"POST",{SendBird:R+C.app_id},function(e){e.error?r.errorFunc(p,e.message):(a=e,a.channels.forEach(function(e,n){e=Q(e)}),r.successFunc(a))},function(e,n){r.errorFunc(e,n)})},ae=function(e){u("=== Get Messaging Channel Pagination List ==="),e=g({},{limit:15,page:1,show_empty:!1},e);var t=g({},q,e),r="messaging_list/",i={app_id:C.app_id,session_key:C.guest_key,page:t.page,limit:t.limit,show_empty:t.show_empty},a={};n(s(r),i,"POST",{SendBird:R+C.app_id},function(e){e.error?t.errorFunc(p,e.message):(a=e,a.channels.forEach(function(e,n){e=Q(e)}),t.successFunc(a))},function(e,n){t.errorFunc(e,n)})},oe=function(t,r){u("=== Messaging Channel Info ===");var s=g({},q,r),i="messaging_info/",a={app_id:C.app_id,session_key:C.guest_key,channel_id:t};n(e(i),a,"POST",{SendBird:R+C.app_id},function(e){e.error?s.errorFunc(p,e.message):W.onMessagingChannelUpdateReceived(Q(e))},function(e,n){s.errorFunc(e,n)})},ce=function(t,r){u("=== Message Mark As Read ===");var s=g({},q,r),i="mark_as_read/",a={app_id:C.app_id,session_key:C.guest_key,channel_url:t},o={};n(e(i),a,"POST",{SendBird:R+C.app_id},function(e){e.error?s.errorFunc(p,e.message):(o=e,s.successFunc(o))},function(e,n){s.errorFunc(e,n)})},ue=function(t){u("=== Message Load More ==="),t=g({},{limit:20},t);var r=g({},q,t),s=(new Date).getTime(),i="message_list",a={app_id:C.app_id,session_key:C.guest_key,channel_url:b.channel_url,message_ts:0==E?s:E,prev_limit:r.limit,next_limit:0,include:!1},o=[];n(e(i),a,"POST",{SendBird:R+C.app_id},function(e){e.error?r.errorFunc(p,e.message):(e.messages.forEach(function(e,n){var t=JSON.parse(e.substring(4));0==E?E=t.ts:E>t.ts&&(E=t.ts),o.push(Ce(e))}),r.successFunc({messages:o}))},function(e,n){r.errorFunc(e,n)})},ge=function(t){u("=== User List ==="),t=g({},{token:"",page:1,limit:30},t);var r=g({},q,t),s="user_list/",i={app_id:C.app_id,session_key:C.guest_key,token:r.token,page:r.page,limit:r.limit};n(e(s),i,"POST",{SendBird:R+C.app_id},function(e){e.error?r.errorFunc(p,e.message):r.successFunc(e)},function(e,n){r.errorFunc(e,n)})},pe=function(e,n){u("=== Upload File ===");var r=g({},q,n),s="upload_file/",i='{"app_id": "'+C.app_id+'"}',a=new FormData;a.append("meta",i),a.append("file",e);var o="",c=l+"v"+S.replace(/[^(0-9)]/gi,"")+"/"+s,_=void 0==r.async?!0:r.async,f=t?new t:new XMLHttpRequest;f.open("POST",c,_),f.onload=function(){if(f.status>=p&&f.status<d){var n=f.responseText,t=JSON.parse(n);t.error?r.errorFunc(p,t.message):(o={error:!1,url:t.url},we({url:t.url,name:e.name,type:e.type,size:e.size,custom:""}),r.successFunc(o))}else r.errorFunc(f.status,f.statusText)},f.send(a)},de=function(){u("=== Typing Start ===");var e=(new Date).getTime();he(N.TPST,{channel_id:b.id,time:e}),A=e,J=!0},_e=function(){u("=== Typing End ===");var e=(new Date).getTime();he(N.TPEN,{channel_id:b.id,time:e}),A=0,J=!1},fe=(setInterval(function(){var e=(new Date).getTime();J&&e-A>x&&_e()},x),function(t,r){u("=== Delete Message ===");var s=g({},q,r),i="message_delete/",a={app_id:C.app_id,session_key:C.guest_key,msg_id:t};n(e(i),a,"POST",{SendBird:R+C.app_id},function(e){e.error?s.errorFunc(p,e.message):s.successFunc(e)},function(e,n){s.errorFunc(e,n)})}),le=function(e){u("=== Web Socket Connect to Server ==="),ke();var n=g({},q,e);try{w=new r(m+P+C.app_id+"&key="+C.guest_key)}catch(t){o.log(t)}w.onopen=function(e){u("=== Web Socket Connected ==="),Oe(!0),Te(C.guest_key);var t=(new Date).getTime();if(void 0===b.id||Fe(b.id,t)){var r={};n.successFunc(r)}else n.errorFunc(d,"WebSocket is not connected yet.")},w.onmessage=function(e){I=(new Date).getTime();for(var n=e.data.split("\n"),t=0;t<n.length;t++)if(0!=n[t].trim().length){var r=n[t].substring(0,4),s=n[t].substring(4);if(0!==r.trim().length||0!==s.trim().length)if(r==N.MCUP){var i=JSON.parse(s);oe(i.channel_id)}else z(r,s)}},w.onerror=function(e){u("=== Web Socket onerror ==="),u(e)},w.onclose=function(e){u("=== Web Socket onclose ==="),u(e),a||ve(),Oe(!1)}},me=function(e){"undefined"==typeof e||1==e?(u("=== Web Socket Explicit Disconnect ==="),a=!0,Oe(!1),Se()):(u("=== Web Socket Disconnect ==="),a=e,ke())},ve=function(){a!==!0&&(null==L?M>O?(Se(),u("=== Start Reconnect (After "+(F/1e3).toString()+" Seconds) ==="),L=setTimeout(function(){O++,F*=2,le(),L=null,u("=== Reconnect done: "+O.toString()+" ===")},F)):(W.onReconnectFailed(),u("=== Stop Reconnect ===")):u("=== Reconnect is in progress. (skip) ==="))},Se=function(){w&&ke(),b={},E=0;try{clearInterval(G),u("=== clearInterval: pingHandler ===")}catch(e){u("=== clearInterval fail: pingHandler ===")}G=null;try{clearTimeout(L),u("=== clearTimeout: retryHandler ===")}catch(e){u("=== clearTimeout fail: retryHandler ===")}L=null,D=0},ke=function(){w&&(w.close(),w.onmessage=function(e){},w.onopen=function(e){},w.onerror=function(e){},w.onclose=function(e){},w=null),E=0},ye=function(){try{return w?w.readyState:r.CLOSED}catch(e){return r.CLOSED}},he=function(e,n){var t=e+JSON.stringify(n)+"\n";try{if(!w)return!1;if(1!=w.readyState)return!1;w.send(t)}catch(r){return u(r),!1}return!0},Te=function(e){he(N.LOGI,{key:e})},Fe=function(e,n){return he(N.JOIN,{channel_id:e,last_ts:n})},Me=function(){var e=(new Date).getTime();D=e,he(N.PING,{id:e})},Oe=function(e){null!=G&&(clearInterval(G),G=null),e?(u("=== Start Pinger ==="),G=setInterval(function(){var e=(new Date).getTime(),n=e-I,t=parseInt(n/1e3);t>0&&t%15==0&&(u(N.PING),Me(),clearTimeout(B),B=setTimeout(function(){var e=(new Date).getTime(),n=e-I,t=parseInt(n/1e3);t>=20&&(u("=== PING Timeout, Try Reconnect ==="),Oe(!1),Se(),ve())},6e3))},1e3)):u("=== Stop Pinger ===")},Pe=function(e,n){"string"!=typeof e&&(e=e.toString()),n=n||"","string"!=typeof n&&(n=n.toString());var t=he(N.MESG,{channel_id:b.id,message:e,data:"",tid:n});W.onMessageDelivery({sent:t,message:e,data:"",id:n}),t&&b.isMessaging&&setTimeout(function(){_e()},100)},Re=function(e,n,t){"string"!=typeof e&&(e=e.toString()),t=t||"","string"!=typeof t&&(t=t.toString());var r=he(N.MESG,{channel_id:b.id,message:e,data:n,tid:t});W.onMessageDelivery({sent:r,message:e,data:n,tid:t}),r&&b.isMessaging&&setTimeout(function(){_e()},100)},we=function(e){he(N.FILE,{channel_id:b.id,name:e.name,url:e.url,type:e.type,size:e.size,custom:e.custom})},Ne=function(e){i=e},Ce=function(e){var n=e.substring(0,4),t=JSON.parse(e.substring(4));return{cmd:n,payload:t}},be=function(e){return e==N.MESG},Ie=function(e){return e==N.FILE},Ee=function(e){var n=e.url.split("."),t=n[n.length-1];return"png"==t||"jpeg"==t||"jpg"==t||"gif"==t||"bmp"==t?!0:e.type.indexOf("image")>=0},Ge=function(e){return e==H},Be=function(e){return e==j},Le=function(e){e({channel_url:b.channel_url,cover_img_url:b.cover_img_url,member_count:b.member_count,name:b.name,isMessaging:b.isMessaging,max_length_message:b.max_length_message,freeze:b.freeze})},De=function(e){e({guest_id:C.guest_id,image_url:C.image_url,nickname:C.user_name})},Je=function(t,r){if(C.guest_key){u("=== Start registerGCMToken ===");var s="register_push_token/",i={app_id:C.app_id,session_key:C.guest_key,gcm_reg_token:t},a=g({},q,r);n(e(s),i,"POST",{SendBird:R+C.app_id},function(e){e.error?(u("=== Fail registerGCMToken ==="),C.gcm_reg_token=t,a.errorFunc(p,e.message)):(u("=== Success registerGCMToken ==="),a.successFunc(e))},function(e,n){C.gcm_reg_token=t,a.errorFunc(e,n)})}else C.gcm_reg_token=t},Ae=function(t,r){if(C.guest_key){u("=== Start registerAPNSToken ===");var s="register_push_token/",i={app_id:C.app_id,session_key:C.guest_key,apns_device_token:t},a=g({},q,r);n(e(s),i,"POST",{SendBird:R+C.app_id},function(e){e.error?(u("=== Fail registerAPNSToken ==="),C.apns_device_token=t,a.errorFunc(p,e.message)):(u("=== Success registerAPNSToken ==="),a.successFunc(e))},function(e,n){C.apns_device_token=t,a.errorFunc(e,n)})}else C.apns_device_token=t},xe=function(t,r){if(C.guest_key){u("=== Start unregisterGCMToken ===");var s="unregister_push_token/",i={app_id:C.app_id,session_key:C.guest_key,gcm_reg_token:t},a=g({},q,r);n(e(s),i,"POST",{SendBird:R+C.app_id},function(e){e.error?(u("=== Fail unregisterGCMToken ==="),C.remove_gcm_token=t,a.errorFunc(p,e.message)):(u("=== Success unregisterGCMToken ==="),C.remove_gcm_token="",a.successFunc(e))},function(e,n){u("=== Fail unregisterGCMToken ==="),C.remove_gcm_token=t,a.errorFunc(e,n)})}else C.remove_gcm_token=t},Ue=function(t,r){if(C.guest_key){u("=== Start unregisterAPNSToken ===");var s="unregister_push_token/",i={app_id:C.app_id,session_key:C.guest_key,apns_device_token:t},a=g({},q,r);n(e(s),i,"POST",{SendBird:R+C.app_id},function(e){e.error?(u("=== Fail unregisterAPNSToken ==="),C.remove_apns_token=t,a.errorFunc(p,e.message)):(C.remove_apns_token="",a.successFunc(e))},function(e,n){u("=== Fail unregisterAPNSToken ==="),C.remove_apns_token=t,a.errorFunc(e,n)})}else C.remove_apns_token=t},ze=function(){return!!b.freeze},qe="[version] "+y,We=function(e){E="string"==typeof e?parseInt(e):e};return{version:qe,events:W,joinChannel:Y,leaveChannel:Z,getMemberList:K,getChannelSearch:V,getChannelList:$,joinMessagingChannel:ee,startMessaging:ne,inviteMessaging:te,endMessaging:se,getMessagingChannelList:ie,getMessagingChannelListPagination:ae,markAsRead:ce,getMessageLoadMore:ue,getUserList:ge,sendFile:pe,typeStart:de,typeEnd:_e,deleteMessage:fe,connect:le,disconnect:me,message:Pe,messageWithData:Re,sendFileURL:we,setDebugMessage:Ne,isMessage:be,isFileMessage:Ie,hasImage:Ee,isGroupMessaging:Ge,isGroupMessagingChannel:Ge,isMessagingChannel:Be,getChannelInfo:Le,getUserInfo:De,getConnectionState:ye,registerGCMToken:Je,registerAPNSToken:Ae,unregisterGCMToken:xe,unregisterAPNSToken:Ue,isFreezeChannel:ze,init:f,setMinMessageTs:We}};return _});